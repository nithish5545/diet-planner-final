<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exercise Planning</title>

<style>
* { margin:0; padding:0; box-sizing:border-box; font-family: Arial,sans-serif; }
body {
    background: linear-gradient(135deg, #0d0d0d, #1a1a1a, #3b3b3b);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    padding:20px;
    color:white;
}
.container {
    width:100%;
    max-width:900px;
    background: rgba(255,255,255,0.1);
    padding:30px;
    border-radius:15px;
}
h2, h3 { text-align:center; margin-bottom:15px; }
.card {
    background: rgba(255,255,255,0.15);
    padding:20px;
    margin:15px 0;
    border-radius:10px;
}
ul { list-style:none; padding-left:0; }
li {
    margin:15px 0;
    padding:15px;
    background: rgba(255,255,255,0.1);
    border-radius:10px;
}
img {
    width:220px;
    border-radius:10px;
    margin-top:10px;
}
button {
    padding:8px 12px;
    margin-top:10px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    background:#00eaff;
    color:#000;
    font-weight:bold;
}
button:hover { background:#00c4d1; }
</style>
</head>

<body>

<div class="container">
    <h2>Exercise Planning</h2>
    <h3>Goal: <span id="userGoal"></span></h3>

    <div class="card">
        <h3>Exercises</h3>
        <ul id="exerciseList"></ul>
    </div>

    <button onclick="location.href='home.html'">Back to Home</button>
</div>

<script>
/* --------------------
   USER SESSION
-------------------- */
const user = JSON.parse(localStorage.getItem("user")) || {
    bodyType: "Weight Loss",
    bmi: 26
};

document.getElementById("userGoal").innerText = user.bodyType;

/* --------------------
   ML-READY RULE (will be ML later)
-------------------- */
function mlSuggestBodyPart(user) {
    if (user.bmi >= 28) return "cardio";
    if (user.bodyType === "Aesthetic") return "chest";
    if (user.bodyType === "Mens Physique") return "shoulders";
    if (user.bodyType === "Bodybuilding") return "back";
    if (user.bodyType === "Weight Gain") return "legs";
    return "cardio";
}

/* --------------------
   LOAD EXERCISES FROM ExerciseDB
-------------------- */
function loadExercises() {
    const bodyPart = mlSuggestBodyPart(user);

    fetch(`https://exercisedb.p.rapidapi.com/exercises/bodyPart/${bodyPart}`, {
        method: "GET",
        headers: {
            "X-RapidAPI-Key": "85fd74d0e6msh71c15f42c28e00dp167f05jsn72dbb484b06a",
            "X-RapidAPI-Host": "exercisedb.p.rapidapi.com"
        }
    })
    .then(res => res.json())
    .then(data => {
        const list = document.getElementById("exerciseList");
        list.innerHTML = "";

        data.slice(0, 6).forEach(ex => {
            const li = document.createElement("li");

            /* âœ… REPLACED BLOCK (GIF SAFE) */
            li.innerHTML = `
                <strong>${ex.name.toUpperCase()}</strong><br>
                Target: ${ex.target}<br>
                Equipment: ${ex.equipment}<br>
                <img 
                    src="${ex.gifUrl}" 
                    alt="Exercise GIF"
                    loading="lazy"
                    onerror="this.style.display='none'; this.insertAdjacentHTML('afterend','<p>GIF not available</p>')"
                >
            `;

            list.appendChild(li);
        });
    })
    .catch(() => alert("Failed to load exercises"));
}

/* INIT */
loadExercises();
</script>

</body>
</html>
